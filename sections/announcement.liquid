{% assign show_on_page = true %}
{% if section.settings.home-page-only and template != 'index' or template == 'password' %}
  {% assign show_on_page = false %}
{% endif %}
{% if collection.handle == 'mindful-eating' %}
{% assign show_on_page = true %}
{% endif %}

{% if section.settings.enabled and show_on_page %}


<div id="announcement"
  class="announcement--root"
  data-section-id="{{ section.id }}"
  data-section-type="announcement"
  data-js-class="IndexAnnouncement"
>
  {% if section.settings.timer  %}
  
   <script>
// Set the date we're counting down to
  var countDownDate = new Date("{{section.settings.date}}").getTime();

// Update the count down every 1 second
  var x = setInterval(function() {

  // Get today's date and time
  var now = new Date().getTime();
    
  // Find the distance between now and the count down date
  var distance = countDownDate - now;
 
  // Time calculations for days, hours, minutes and seconds
  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
  var seconds = Math.floor((distance % (1000 * 60)) / 1000);
    
  // Output the result in an element with id="demo"
    document.getElementById("sday").innerHTML = days;
    document.getElementById("shour").innerHTML = hours;
    document.getElementById("smin").innerHTML = minutes;
    document.getElementById("ssec").innerHTML = seconds;
    
  // If the count down is over, write some text 
  if (distance < 0 ) {
      clearInterval(x);
    document.getElementById("announcement").style.display = "none";
  }
}, 1000);
  
</script>
  
  <div class="announcement-wrap timer-announcement">

  {% if section.settings.link != blank %}
    <a class="announcement--link" href="{{ section.settings.link }}">
  {% endif %}

  <div class="announcement--wrapper">


    {% if section.settings.text != blank %}
      <div class="announcement--text font--accent">
        {{ section.settings.text | escape }}
      </div>
    {% endif %}
  </div>

  {% if section.settings.link != blank %}
    </a>
  {% endif %}
<div id="sale_time">
    <div class="sell-timer">
      <div><span id="sday"></span> day</div>
      <div><span id="shour"></span> hours</div>
      <div><span id="smin"></span> minutes</div>
      <div><span id="ssec"></span> seconds</div>
    </div>
    
  </div>
<div class="sell-end-time">
    Sale ends {{section.settings.date}}
    </div>
  
</div>
  
  {% else %}
  
 <div class="announcement-wrap">

  {% if section.settings.link != blank %}
    <a class="announcement--link" href="{{ section.settings.link }}" style="padding-top:8px;">
  {% endif %}
      
	<div class="announcement--wrapper">
    
      <div class="announcement--text font--accent">
         {{ section.settings.text | escape }}
      </div>
    
  </div>
      

  {% if section.settings.link != blank %}
    </a>
  {% endif %}


  
</div> 
  {% endif %}
</div>

{% endif %}



<style>
  #announcement{
    background-color:{{section.settings.bgColor}};
    color:{{section.settings.textColor}};
  }
.announcement-wrap {
    display: flex;
    flex: 1;
    justify-content: space-around;
    align-items: center;
    max-width: 1200px;
    margin: auto;
    flex-wrap: wrap;
      padding:10px;

}
.announcement-wrap.timer-announcement {
    display: flex;
    flex: 1;
    justify-content: space-around;
    align-items: center;
    max-width: 1200px;
    margin: auto;
    flex-wrap: wrap;
    padding: 8px 0;
}
.announcement-wrap a .announcement--wrapper {
    white-space: initial;
    line-height: 1.4;
    padding: 0 0;
    text-align: center;
}
.announcement-wrap a .announcement--wrapper .announcement--text {
    font-size: 14px;
}
.announcement-wrap.timer-announcement>* {
    width: 30%}
.announcement-wrap.timer-announcement .sell-timer {
    display: flex;
    flex: 1;
    justify-content: center;
}
.announcement-wrap .sell-timer>div {
    padding: 0 8px;
    font-size: 16px;
    text-align: center;
}
.announcement-wrap .sell-timer>div span {
    width: 100%;
    font-size: 25px;
    display: block;
}
.sell-end-time {
    font-size: 22px;
}
.layout--header {
    padding-top: 10px;
    padding-bottom: 10px;
    height: 70px;
}
@media(max-width:991px) {
    .announcement-wrap a {
    width: 100%;
    padding-bottom: 8px;
    margin-bottom: 5px;
    border-bottom: 0;
}
.announcement-wrap>div {
    width: 50%}
.announcement-wrap .sell-timer>div {
    padding: 0 5px;
    font-size: 14px;
    text-align: center;
}
.announcement-wrap .sell-timer>div span {
    width: 100%;
    font-size: 20px;
    display: block;
}
.sell-end-time {
    font-size: 18px;
}
.announcement-wrap {
    border: 0;
}
}@media(max-width:768px) {
    .announcement-wrap a .announcement--wrapper {
    white-space: normal;
}
  #sale_time,.sell-end-time{
  	display:none;
  }
  .announcement-wrap.timer-announcement>*{
  	width:100%;
    text-align:center;
  }
  .announcement--text{
  	font-size:11px;
  }
  .announcement-wrap>div{width:100%;text-align:center;}
}
</style>



{% schema %}
{
  "name": "Announcement",
  "settings": [
    {
      "type": "checkbox",
      "id": "enabled",
      "label": "Show announcement",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "home-page-only",
      "label": "Home page only",
      "default": true
    },
{
      "type": "checkbox",
      "id": "timer",
      "label": "Show announcement timer",
      "default": false
    },
{
      "type": "color",
      "id": "bgColor",
      "label": "Background Color",
      "default": "#ffffff"
    },
{
      "type": "color",
      "id": "textColor",
      "label": "Text Color",
      "default": "#444444"
    },
    {
      "type": "text",
      "id": "text",
      "label": "Text",
      "default": "Add your announcement message"
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link"
    },
{
      "type": "text",
      "id": "date",
      "label": "Sale End Time",
	  "default": "nov 15, 2021 0:0:0"
    }
  ]
}
{% endschema %}

